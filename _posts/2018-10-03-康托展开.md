---
layout: post
title: 全排列康托展开
date: 2018-10-3
categories: blog
tags: [算法,全排列]
description: 将全排列和字典序排名一一映射
---

给定一个1\~n的排列A,求A在所有排列中的字典序排名(0是最小的).  
从左到右考虑(字典序的优先方向),第一个数是 $A_1$,那么对于任意排列B若 $B_1<A_1$,则B的字典序必然比A小.   
~~显然~~这样的B有 $(A_{1}-1)\*(n-1)!$个.  
这样推下去,对于任意 $A_i$若在 $A_{i+1~n}$中有 $k_i$个数比 $A_i$小,则可以找到 $k_i\*(n-i)!$个字典序比A小的排列B满足 $B_{1~i-1}=A_{1~i-1}$且 $B_i<A_i$.  
这样的B自然不会重复.  
于是排列A的字典需排名rank(A)就很容易发现了:  
$$rank(A)\;=\;\sum_{i=1}^{n}k_i\*(n-i)!$$  
$$k_i\;=\;\sum_{j=i}^{n}A_{j}<A_{i}$$  
可以 $O(n^2)$求出.  

那么如果已知一个rank(A),怎么反求出A呢?  


