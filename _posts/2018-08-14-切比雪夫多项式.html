---
layout: post
title: 切比雪夫多项式
date: 2018-8-14
categories: blog
tags: [算法,切比雪夫多项式]
description: 转载
---

<!-- <html lang="zh-cn"> -->
<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/7562111.html">原文地址</a>
<meta charset="utf-8"/>
<div id="cnblogs_post_body" class="blogpost-body"><a name="_labelTop"></a><div id="navCategory"><p style="font-size:18px"><b>目录</b></p><ul><li><a href="#_label0">解析</a></li><li><a href="#_label1">推广</a></li><li><a href="#_label2">解析</a></li></ul></div><p>&nbsp;</p><h1 style="text-align: center;" id="autoid-0-0-0">切比雪夫多项式</h1>
<p>&nbsp;</p>
<h3 id="autoid-1-0-0">概述：</h3>
<p>切比雪夫多项式是与棣美弗定理有关，以递归方式定义的一系列正交多项式序列。 通常，第一类切比雪夫多项式以符号Tn表示， 第二类切比雪夫多项式用Un表示。切比雪夫多项式 Tn 或 Un 代表 n 阶多项式。</p>
<p>切比雪夫多项式在逼近理论中有重要的应用。这是因为第一类切比雪夫多项式的根（被称为切比雪夫节点）可以用于多项式插值。相应的插值多项式能最大限度地降低龙格现象，并且提供多项式在连续函数的最佳一致逼近。</p>
<p>&nbsp;</p>
<h3 id="autoid-1-0-1">基本性质：</h3>
<p>对每个非负整数n， Tn(x) 和 Un(x) 都为 n次多项式。 并且当n为偶（奇）数时，它们是关于x 的偶（奇）函数， 在写成关于x的多项式时只有偶（奇）次项。</p>
<p>&nbsp;</p>
<p>按切比雪夫多项式的展开式：</p>
<p align="left">一个N 次多项式按切比雪夫多项式的展开式为如下，多项式按切比雪夫多项式的展开可以用 Clenshaw 递推公式计算。第一类切比雪夫多项式由以下递推关系确定。</p>
<p align="left">&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150344103-460546445.png" alt=""/></p>
<p align="left">也可以用母函数表示。</p>
<p>&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150401603-856488059.png" alt=""/></p>
<p align="left">第二类切比雪夫多项式&nbsp;由以下递推关系给出。</p>
<p align="left">&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150416134-1332996858.png" alt=""/></p>
<p align="left">此时母函数为</p>
<p align="left">&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150427025-1986901210.png" alt=""/></p>
<h3 id="autoid-1-0-2" align="left">Clenshaw递推公式</h3>
<p align="left">在数值分析中，Clenshaw递推公式&nbsp;(由Charles William Clenshaw发现)是一个求切比雪夫多项式的值的递归方法。</p>
<p align="left">&nbsp;</p>
<h3 id="autoid-1-0-3" align="left">切比雪夫多项式</h3>
<p align="left"><em>N</em>次切比雪夫多项式，是下面形式的多项式<em>p</em>(<em>x</em>)</p>
<p align="left">&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150534384-1769844184.png" alt=""/></p>
<p>&nbsp;</p>
<p align="left">其中<em>T</em><em><sub>n</sub></em>是<em>n</em>阶切比雪夫多项式</p>
<p align="left">&nbsp;</p>
<h3 id="autoid-1-0-4" align="left">Clenshaw递推公式</h3>
<p align="left">Clenshaw递推公式可以用来计算切比雪夫多项式的值。给定</p>
<p align="left">&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150629400-1514610152.png" alt=""/></p>
<p>&nbsp;</p>
<p align="left">我们定义</p>
<p align="left">&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150651118-251802754.png" alt=""/></p>
<p align="left">于是</p>
<p align="left">&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150711071-462038226.png" alt=""/></p>
<p>&nbsp;</p>
<p align="left">(注)上面的公式在&nbsp;N=0,1的情况下无意义。此时我们可以用下面的公式：</p>
<p align="left">&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150802571-1541550390.png" alt=""/></p>
<p align="left"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150811212-19347029.png" alt=""/></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150817790-1150988229.png" alt=""/></p>
<p style="text-align: center;" align="left">(downward, omit if N=0)</p>
<p align="left"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150901853-114366214.png" alt=""/></p>
<p align="left"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150914978-294321040.png" alt=""/></p>
<p>&nbsp;</p>
<p align="left">这里</p>
<p align="left"><img src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150933462-1074528266.png" alt=""/></p>
<p align="left">或者</p>
<p align="left">&nbsp;<img src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920150959931-1978147818.png" alt=""/></p>
<p align="left">其中<img src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920151020118-908147891.png" alt=""/>是第二类切比雪夫多项式</p>
<h3 id="autoid-1-0-5" align="left">棣莫弗（de Moivre）原理</h3>
<p>　　设两个复数（用三角形式表示）Z1=r1(cosθ1+isinθ1），Z2=r2(cosθ2+isinθ2），则:</p>
<p>　　Z1Z2=r1r2[cos（θ1+θ2）+isin（θ1+θ2）].</p>
<div>
<div style="text-align: right"><a href="#_labelTop">Return Top</a><a name="_label0"></a></div><h2 id="autoid-1-0-6">解析</h2>
</div>
<p>　　证：先讲一下复数的三角形式的概念。在复平面C上，用向量<strong>Z</strong>(a,b）来表示Z=a+bi.于是，该向量可以分成两个在实轴，虚轴上的分向量.如果向量<strong>Z</strong>与实轴的夹角为θ，这两个分向量的模分别等于rcosθ,risinθ（r=√a^2+b^2）.所以，复数Z可以表示为Z=r(cosθ+isinθ）.这里θ称为复数Z的辐角.</p>
<p>　　因为Z1=r1(cosθ1+isinθ1），Z2=r2(cosθ2+isinθ2），所以</p>
<p>　　Z1Z2=r1r2(cosθ1+isinθ1）（cosθ2+isinθ2）</p>
<p>　　=r1r2(cosθ1cosθ2+icosθ1sinθ2+isinθ1cosθ2-sinθ1sinθ2）</p>
<p>　　=r1r2[(cosθ1cosθ2-sinθ1sinθ2）+i(cosθ1sinθ2+sinθ1cosθ2）]</p>
<p>　　=r1r2[cos（θ1+θ2）+isin（θ1+θ2）].</p>
<p>　　其实该定理可以推广为一般形式：</p>
<div>
<div style="text-align: right"><a href="#_labelTop">Return Top</a><a name="_label1"></a></div><h2 id="autoid-1-1-0">推广</h2>
</div>
<p>　　设n个复数Z1=r1(cosθ1+isinθ1），Z2=r2(cosθ2+isinθ2），……，Zn=rn(cosθn+isinθn），则：</p>
<p>　　Z1Z2……Zn=r1r2……rn[cos（θ1+θ2+……+θn)+isin（θ1+θ2+……+θn)].</p>
<div>
<div style="text-align: right"><a href="#_labelTop">Return Top</a><a name="_label2"></a></div><h2 id="autoid-1-2-0">解析</h2>
</div>
<p>　　证：用数学归纳法即可，归纳基础就是两个复数相乘的棣莫弗定理。</p>
<p>　　如果把棣莫弗定理和欧拉（Euler）公式“e^iθ=cosθ+isinθ”（参见《泰勒公式》，严格的证明需要复分析）放在一起看，则可以用来理解欧拉公式的意义。</p>
<p>　　利用棣莫弗定理有：</p>
<p>　　Z1Z2……Zn=r1r2……rn [cos（θ1+θ2+……+θn)+isin（θ1+θ2+……+θn)]</p>
<p>　　如果可以把所有的复数改写成指数的形式，即：Z1=r1e^iθ1,Z2=r2e^iθ2，……，Zn=rne^iθn,</p>
<p>　　Z1Z2……Zn=r1r2……rn e^i（θ1+θ2+……+θn)</p>
<p>　　这和指数的可加性一致.</p>
<p align="left">　　在一般形式中如果令Z1=Z2=……=Zn=Z，则能导出复数开方的公式.有兴趣可自己推推看.</p>
<p align="left">下面这题可作为切比雪夫多项式的模版：</p>
<h1 id="autoid-1-3-0" align="center"><strong><span style="color: #1a5cc8;">Trig Function<span style="color: green;"><br>
</span></span></strong></h1>
<p align="center"><strong><span style="color: green;">TimeLimit: 2000/1000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit:32768/32768 K (Java/Others)<br>
Total Submission(s): 714&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 206<br>
<br>
</span></strong></p>
<p><strong><span style="color: #7ca9ed;"><span style="font-size: 14px;">Problem Description</span></span></strong></p>
<p style="background: white;">&nbsp;</p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">f(cos(x))=cos(n∗x) holds for all x.</span></span></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">Given two integersn and m , you need to calculate the coefficient of x^m​​ in f(x), modulo 998244353</span></span></p>
<p style="background: white;">&nbsp;</p>
<p align="left">

<span style="font-size: 14px;"><span style="font-size: 14px;">&nbsp;<span style="font-size: 14px;">&nbsp;</span></span></span></p>
<p><strong><span style="color: #7ca9ed;"><span style="font-size: 14px;">Input</span></span></strong></p>
<p style="background: white;">&nbsp;</p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">Multiple testcases (no more than 100).</span></span></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">Each test casecontains one line consisting of two integers n and m.</span></span></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">1≤n≤10<sup><span style="font-size: 14px;">9</span></sup><span style="font-size: 14px;">,0≤m≤10<sup><span style="font-size: 14px;">4</span></sup></span></span></span></p>
<p style="background: white;">&nbsp;</p>
<p align="left">
<span style="font-size: 14px;"><span style="font-size: 14px;"><span style="font-size: 14px;"><span style="font-size: 14px;">
<span style="font-size: 14px;">&nbsp;<span style="font-size: 14px;">&nbsp;</span></span></span></span></span></span></p>
<p><strong><span style="color: #7ca9ed;"><span style="font-size: 14px;">Output</span></span></strong></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">Output the answerin a single line for each test case.</span></span></p>
<p align="center"><span style="font-size: 14px;">&nbsp;<span style="font-size: 14px;">&nbsp;</span></span></p>
<p><strong><span style="color: #7ca9ed;"><span style="font-size: 14px;">Sample Input</span></span></strong></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">2 0</span></span></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">2 1</span></span></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">2 2</span></span></p>
<p><span style="font-size: 14px;">&nbsp;</span></p>
<p><strong><span style="color: #7ca9ed;"><span style="font-size: 14px;">Sample Output</span></span></strong></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">998244352</span></span></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">0</span></span></p>
<p style="margin: 0px;"><span style="margin: 0px;" lang="EN-US"><span style="font-size: 14px;">2</span></span></p>
<p><span style="font-size: 14px;"><br>
</span></p>
<p><span style="font-size: 14px;">【题意】</span></p>
<p><span style="font-size: 14px;">给出一个函数，代入n,m后求出x<sup><span style="font-size: 14px;">m</span></sup><span style="font-size: 14px;">的系数，并取模输出。</span></span></p>
<p><span style="font-size: 14px;"><br>
</span></p>
<p><span style="font-size: 14px;">【思路】</span></p>
<p><span style="font-size: 14px;"><br>
</span></p>
<p><span style="font-size: 14px;">我们先尝试把cos(nx)化为cos(x)的形式，然后把cos(x)用x代换，就可以得到f(x)=...的形式，然后就能得到所求的系数了。</span></p>
<p><span style="font-size: 14px;"><br>
</span></p>
<p><span style="font-size: 14px;">那么我们如何把cos(nx)化为cos(x)的形式呢。</span></p>
<p><span style="font-size: 14px;"><br>
</span></p>
<p><span style="font-size: 14px;">其实可以尝试着暴力写出前几项的形式。如下图：</span></p>
<p><span style="font-size: 14px;"><img src="https://images2017.cnblogs.com/blog/1100338/201709/1100338-20170920155541306-1831832325.jpg" alt=""/></span></p>
<p>&nbsp;</p>
<p><span style="font-size: 14px;">由写出的式子，我们可以发现以下几点：</span></p>
<ol>
<li><span style="font-size: 14px;">当m大于n时，答案显然为0。</span></li>
<li style="margin-top: 0.25em;"><span style="font-size: 14px;">当n为奇数且m为偶数或n为偶数且m为奇数时答案显然为0。</span></li>
<li style="margin-top: 0.25em;"><span style="font-size: 14px;">当n为奇数，且m为1时，答案的绝对值为n。</span></li>
<li style="margin-top: 0.25em;"><span style="font-size: 14px;">当n为偶数，且m为0时，答案的绝对值为1。</span></li>
<li style="margin-top: 0.25em;"><span style="font-size: 14px;">其余情况答案的绝对值均为【 n * (n-m+2) * (n-m+4) * ... * (n+m-4) * (n+m-2) 】/(m!)。(注意逆元的运用)</span></li>
<li style="margin-top: 0.25em;"><span style="font-size: 14px;">上面出现绝对值的情况，3和4 当(n/2)%2 == 0 时符号为正，否则为负；5 当((n-m)/2)%2 == 0时，符号为正，否则符号为负。</span></li>



</ol>
<p><span style="font-size: 14px;">依照这个规律分类讨论一下即可。</span></p>
<p><span style="font-size: 14px;">于是我们可以得到以下一般解析式</span></p>
<p><span style="font-size: 18px;"><span style="font-size: 18px;"><img src="http://img.blog.csdn.net/20170916181047210" alt=""/></span></span></p>
<p><span style="font-size: 18px;">注意"!!"不是阶乘的阶乘，而是不超过n且与n具有相同奇偶性的所有正整数连乘积。</span></p>
<p><span style="font-size: 18px;">n分类讨论下,当n为偶数时m=2*k, n为奇数时m=2*k-1</span></p>
<p><span style="font-size: 18px;">还有注意下"!!"的约分,可能下面的比上面的大</span></p>
<p>于是我们就得到了以下代码：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"/></a></span></div>
<pre class="prettyprint prettyprinted" style=""><span style="color: #008080;"><span class="pln"> </span><span class="lit">1</span></span><span class="pln"> </span><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span style="color: #008080;"><span class="pln"> </span><span class="lit">2</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">using</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">namespace</span></span><span style="color: #000000;"><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="pln"> </span><span class="lit">3</span></span><span class="pln"> </span><span class="kwd">typedef</span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">long</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">long</span></span><span style="color: #000000;"><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="pln"> </span><span class="lit">4</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">const</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">int</span></span><span class="pln"> maxn</span><span class="pun">=</span><span class="lit">1e5</span><span class="pun">+</span><span style="color: #800080;"><span class="lit">5</span></span><span style="color: #000000;"><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="pln"> </span><span class="lit">5</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">const</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">int</span></span><span class="pln"> mod</span><span class="pun">=</span><span style="color: #800080;"><span class="lit">998244353</span></span><span style="color: #000000;"><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="pln"> </span><span class="lit">6</span></span><span class="pln"> ll fac</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">]={</span><span style="color: #800080;"><span class="lit">1</span></span><span style="color: #000000;"><span class="pun">};</span><span class="pln">
</span></span><span style="color: #008080;"><span class="pln"> </span><span class="lit">7</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">ll n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="pln"> </span><span class="lit">8</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">void</span></span><span style="color: #000000;"><span class="pln"> init</span><span class="pun">()</span><span class="pln">
</span></span><span style="color: #008080;"><span class="pln"> </span><span class="lit">9</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">10</span></span><span class="pln">     </span><span style="color: #0000ff;"><span class="kwd">for</span></span><span class="pun">(</span><span style="color: #0000ff;"><span class="kwd">int</span></span><span class="pln"> i</span><span class="pun">=</span><span style="color: #800080;"><span class="lit">1</span></span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">maxn</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++</span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">11</span></span><span class="pln">         fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span style="color: #800080;"><span class="lit">1</span></span><span class="pun">]*</span><span class="pln">i</span><span class="pun">%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">12</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">13</span></span><span class="pln"> ll qmod</span><span class="pun">(</span><span class="pln">ll x</span><span class="pun">,</span><span style="color: #0000ff;"><span class="kwd">int</span></span><span style="color: #000000;"><span class="pln"> q</span><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">14</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">15</span></span><span class="pln">     ll res</span><span class="pun">=</span><span style="color: #800080;"><span class="lit">1</span></span><span style="color: #000000;"><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">16</span></span><span class="pln">     </span><span style="color: #0000ff;"><span class="kwd">while</span></span><span style="color: #000000;"><span class="pun">(</span><span class="pln">q</span><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">17</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">    </span><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">18</span></span><span class="pln">         </span><span style="color: #0000ff;"><span class="kwd">if</span></span><span class="pun">(</span><span class="pln">q</span><span class="pun">%</span><span style="color: #800080;"><span class="lit">2</span></span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">19</span></span><span class="pln">             res</span><span class="pun">=</span><span class="pln">res</span><span class="pun">*</span><span class="pln">x</span><span class="pun">%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">20</span></span><span class="pln">         x</span><span class="pun">=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">x</span><span class="pun">%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">21</span></span><span class="pln">         q</span><span class="pun">/=</span><span style="color: #800080;"><span class="lit">2</span></span><span style="color: #000000;"><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">22</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">    </span><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">23</span></span><span class="pln">     </span><span style="color: #0000ff;"><span class="kwd">return</span></span><span style="color: #000000;"><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">24</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">25</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">int</span></span><span class="pln"> main</span><span class="pun">(</span><span style="color: #0000ff;"><span class="kwd">void</span></span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">26</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">27</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">    init</span><span class="pun">();</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">28</span></span><span class="pln">     </span><span style="color: #0000ff;"><span class="kwd">while</span></span><span class="pun">(~</span><span class="pln">scanf</span><span class="pun">(</span><span style="color: #800000;"><span class="str">"</span></span><span style="color: #800000;"><span class="str">%lld%lld</span></span><span style="color: #800000;"><span class="str">"</span></span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">,&amp;</span><span style="color: #000000;"><span class="pln">m</span><span class="pun">))</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">29</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">    </span><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">30</span></span><span class="pln">         </span><span style="color: #0000ff;"><span class="kwd">if</span></span><span class="pun">(</span><span class="pln">m</span><span class="pun">&gt;</span><span style="color: #000000;"><span class="pln">n</span><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">31</span></span><span class="pln">             puts</span><span class="pun">(</span><span style="color: #800000;"><span class="str">"</span></span><span style="color: #800000;"><span class="str">0</span></span><span style="color: #800000;"><span class="str">"</span></span><span style="color: #000000;"><span class="pun">);</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">32</span></span><span class="pln">         </span><span style="color: #0000ff;"><span class="kwd">else</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">if</span></span><span class="pun">(</span><span class="pln">n</span><span class="pun">%</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">&amp;&amp;</span><span class="pln">m</span><span class="pun">%</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">==</span><span style="color: #800080;"><span class="lit">0</span></span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">33</span></span><span class="pln">             puts</span><span class="pun">(</span><span style="color: #800000;"><span class="str">"</span></span><span style="color: #800000;"><span class="str">0</span></span><span style="color: #800000;"><span class="str">"</span></span><span style="color: #000000;"><span class="pun">);</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">34</span></span><span class="pln">         </span><span style="color: #0000ff;"><span class="kwd">else</span></span><span class="pln"> </span><span style="color: #0000ff;"><span class="kwd">if</span></span><span class="pun">(</span><span class="pln">n</span><span class="pun">%</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">==</span><span style="color: #800080;"><span class="lit">0</span></span><span class="pun">&amp;&amp;</span><span class="pln">m</span><span class="pun">%</span><span style="color: #800080;"><span class="lit">2</span></span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">35</span></span><span class="pln">             puts</span><span class="pun">(</span><span style="color: #800000;"><span class="str">"</span></span><span style="color: #800000;"><span class="str">0</span></span><span style="color: #800000;"><span class="str">"</span></span><span style="color: #000000;"><span class="pun">);</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">36</span></span><span class="pln">         </span><span style="color: #0000ff;"><span class="kwd">else</span></span><span class="pln">
</span><span style="color: #008080;"><span class="lit">37</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">        </span><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">38</span></span><span class="pln">             ll fz</span><span class="pun">=</span><span class="pln">n</span><span class="pun">%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">39</span></span><span class="pln">             </span><span style="color: #0000ff;"><span class="kwd">if</span></span><span class="pun">(</span><span class="pln">m</span><span class="pun">&gt;=</span><span style="color: #800080;"><span class="lit">1</span></span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">40</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">            </span><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">41</span></span><span class="pln">                 </span><span style="color: #0000ff;"><span class="kwd">for</span></span><span class="pun">(</span><span style="color: #0000ff;"><span class="kwd">int</span></span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">-</span><span class="pln">m</span><span class="pun">+</span><span style="color: #800080;"><span class="lit">1</span></span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">+</span><span class="pln">m</span><span class="pun">-</span><span style="color: #800080;"><span class="lit">1</span></span><span class="pun">;</span><span class="pln">i</span><span class="pun">++</span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">42</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">                </span><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">43</span></span><span class="pln">                     </span><span style="color: #0000ff;"><span class="kwd">if</span></span><span class="pun">(</span><span class="pln">i</span><span class="pun">%</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">==(</span><span class="pln">n</span><span class="pun">+</span><span class="pln">m</span><span class="pun">-</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">)%</span><span style="color: #800080;"><span class="lit">2</span></span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">44</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">                    </span><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">45</span></span><span class="pln">                         fz</span><span class="pun">=</span><span class="pln">fz</span><span class="pun">*</span><span class="pln">i</span><span class="pun">%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">46</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">                    </span><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">47</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">                </span><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">48</span></span><span class="pln">                 ll tmp</span><span class="pun">=</span><span class="pln">fz</span><span class="pun">*</span><span class="pln">qmod</span><span class="pun">(</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">m</span><span class="pun">],</span><span class="pln">mod</span><span class="pun">-</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">)%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">49</span></span><span class="pln">                 </span><span style="color: #0000ff;"><span class="kwd">if</span></span><span class="pun">((</span><span class="pln">n</span><span class="pun">-</span><span class="pln">m</span><span class="pun">)/</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">%</span><span style="color: #800080;"><span class="lit">2</span></span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">50</span></span><span class="pln">                     tmp</span><span class="pun">=-</span><span style="color: #000000;"><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">51</span></span><span class="pln">                 printf</span><span class="pun">(</span><span style="color: #800000;"><span class="str">"</span></span><span style="color: #800000;"><span class="str">%lld\n</span></span><span style="color: #800000;"><span class="str">"</span></span><span class="pun">,(</span><span class="pln">tmp</span><span class="pun">+</span><span class="pln">mod</span><span class="pun">)%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">);</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">52</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">            </span><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">53</span></span><span class="pln">             </span><span style="color: #0000ff;"><span class="kwd">else</span></span><span class="pln">
</span><span style="color: #008080;"><span class="lit">54</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">            </span><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">55</span></span><span class="pln">                 ll t</span><span class="pun">=</span><span style="color: #800080;"><span class="lit">1</span></span><span style="color: #000000;"><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">56</span></span><span class="pln">                 </span><span style="color: #0000ff;"><span class="kwd">for</span></span><span class="pun">(</span><span style="color: #0000ff;"><span class="kwd">int</span></span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">+</span><span class="pln">m</span><span class="pun">-</span><span style="color: #800080;"><span class="lit">1</span></span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">-</span><span class="pln">m</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++</span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">57</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">                </span><span class="pun">{</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">58</span></span><span class="pln">                     </span><span style="color: #0000ff;"><span class="kwd">if</span></span><span class="pun">(</span><span class="pln">i</span><span class="pun">%</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">==(</span><span class="pln">n</span><span class="pun">+</span><span class="pln">m</span><span class="pun">-</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">)%</span><span style="color: #800080;"><span class="lit">2</span></span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">59</span></span><span class="pln">                         t</span><span class="pun">=</span><span class="pln">t</span><span class="pun">*</span><span class="pln">i</span><span class="pun">%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">60</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">                </span><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">61</span></span><span class="pln">                 ll tmp</span><span class="pun">=</span><span class="pln">fz</span><span class="pun">*</span><span class="pln">qmod</span><span class="pun">(</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">m</span><span class="pun">],</span><span class="pln">mod</span><span class="pun">-</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">qmod</span><span class="pun">(</span><span class="pln">t</span><span class="pun">,</span><span class="pln"> mod</span><span class="pun">-</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">)%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">62</span></span><span class="pln">                 </span><span style="color: #0000ff;"><span class="kwd">if</span></span><span class="pun">((</span><span class="pln">n</span><span class="pun">-</span><span class="pln">m</span><span class="pun">)/</span><span style="color: #800080;"><span class="lit">2</span></span><span class="pun">%</span><span style="color: #800080;"><span class="lit">2</span></span><span style="color: #000000;"><span class="pun">)</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">63</span></span><span class="pln">                     tmp</span><span class="pun">=-</span><span style="color: #000000;"><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">64</span></span><span class="pln">                 printf</span><span class="pun">(</span><span style="color: #800000;"><span class="str">"</span></span><span style="color: #800000;"><span class="str">%lld\n</span></span><span style="color: #800000;"><span class="str">"</span></span><span class="pun">,(</span><span class="pln">tmp</span><span class="pun">+</span><span class="pln">mod</span><span class="pun">)%</span><span style="color: #000000;"><span class="pln">mod</span><span class="pun">);</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">65</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">            </span><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">66</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">        </span><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">67</span></span><span class="pln"> </span><span style="color: #000000;"><span class="pln">    </span><span class="pun">}</span><span class="pln">
</span></span><span style="color: #008080;"><span class="lit">68</span></span><span class="pln"> </span><span class="pun">}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"/></a></span></div></div>
<p>&nbsp;</p></div>
