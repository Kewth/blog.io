---
layout: post
title: 整除分块
date: 2018-09-05
categories: blog
tags: [算法,分块]
description: 积累
---

(以下的除号皆表示整除)  
用数论函数计算的时候,总会遇到这样一种问题:
<img src="http://latex.codecogs.com/gif.latex?\sum_{i=1}^nf(\frac{n}{i})"/>  
O(n)求往往无法满足需要  
但是~~打表~~可以发现,n/i的取值对于一段连续的i是一致的  
那么可以考虑一块一块求  
设已知当前块的左端点为l,如果知道右端点r(左闭右开),意味着
<img src="http://latex.codecogs.com/gif.latex?\forall l<=i<r,\frac{n}{i} = \frac{n}{l}"/>
,这一块对答案的贡献就是
<img src="http://latex.codecogs.com/gif.latex?(r-l)*f(\frac{n}{l})"/>  
结论是
<img src="http://latex.codecogs.com/gif.latex?r=n/(n/l)+1"/>
~~,其实我还不会证~~  
那么可以枚举块,当前l,r可以求得,下一个块的l显然是当前r  

有时候会有点变化:要求
<img src="http://latex.codecogs.com/gif.latex?\sum_{i=1}^{min(n,m)}f(\frac{n}{i})*f(\frac{m}{i})"/>  
还是会存在
<img src="http://latex.codecogs.com/gif.latex?\forall l<=i<r,\frac{n}{i}=\frac{n}{l}\;\&\;\frac{m}{i}=\frac{m}{l}"/>  
所以这样的区间的右端点为:
<img src="http://latex.codecogs.com/gif.latex?r=min(n/(n/l)\;,\;m/(m/l))+1"/>  
所以还是可以一块一块的枚举求和  
